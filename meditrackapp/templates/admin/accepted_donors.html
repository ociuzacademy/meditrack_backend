{% extends 'admin/admin_index.html' %}

{% block content %}

<style>
    .page-title {
        font-weight: 700;
        color: #2a0945;
        text-align: center;
        margin-top: 40px;
        margin-bottom: 25px;
    }

    .donor-table-container {
        background: #fff;
        padding: 25px;
        border-radius: 15px;
        box-shadow: 0 5px 20px rgba(73, 10, 98, 0.08);
        animation: fadeIn 0.4s ease-in-out;
    }

    table {
        border-radius: 10px;
        overflow: hidden;
    }

    thead.table-dark {
        background-color: #2a0945 !important;
        color: #ffffff !important;
    }

    .table-striped tbody tr:nth-of-type(odd) {
        background-color: #f2eaff !important;
    }

    .table-striped tbody tr:hover {
        background-color: #e4d4ff !important;
        transition: 0.2s;
    }

    .badge-status {
        padding: 7px 12px;
        border-radius: 8px;
        font-size: 0.8rem;
        font-weight: 600;
    }

    .badge-accepted { background-color: #f7d774; color: #2a0945; }
    .badge-completed { background-color: #2a0945; color: white; }
    .btn-complete {
        background-color: #2a0945 !important;
        color: #fff !important;
        border: none;
        padding: 6px 14px;
        border-radius: 8px;
        font-weight: 600;
    }
</style>

<div class="container">

    <h2 class="page-title">Accepted Donors for Request #{{ request_obj.id }}</h2>

    <div class="donor-table-container">
        <table class="table table-bordered table-striped align-middle">
            <thead class="table-dark">
                <tr>
                    <th>Donor Name</th>
                    <th>Blood Group</th>
                    <th>Location</th>
                    <th>Accepted On</th>
                    <th>Status</th>
                    <th>Action</th>
                </tr>
            </thead>

            <tbody>
                {% for a in accepted_donors %}
                <tr>
                    <td>{{ a.donor.user.username }}</td>
                    <td>{{ a.donor.blood_group }}</td>
                    <td>{{ a.donor.location }}</td>
                    <td>{{ a.accepted_at|date:"d M Y, h:i A" }}</td>

                    <!-- STATUS -->
                    <td>
                        {% if a.status == "accepted" %}
                            <span class="badge-status badge-accepted">Pending</span>
                        {% else %}
                            <span class="badge-status badge-completed">Completed</span>
                        {% endif %}
                    </td>

                    <!-- ACTION -->
                    <td>
                        {% if a.status == "accepted" %}
                            <a href="{% url 'admin_complete_donation' a.id %}"
                               class="btn-complete btn-sm">
                                Mark Completed
                            </a>
                        {% else %}
                            <span class="text-muted">Done</span>
                        {% endif %}
                    </td>

                </tr>
                {% empty %}
                <tr>
                    <td colspan="6" class="text-center text-muted">
                        No donors have accepted this request yet.
                    </td>
                </tr>
                {% endfor %}
            </tbody>

        </table>
    </div>

</div>

{% endblock %}
