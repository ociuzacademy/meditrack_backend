{% extends 'admin/admin_index.html' %}
{% block content %}

<!-- Auto-refresh every 5 seconds -->
<meta http-equiv="refresh" content="5">

<style>

    /* Title */
    .dashboard-title {
        text-align: center;
        font-weight: 700;
        color: #300a4f;
        margin: 40px 0 30px 0;
    }

    /* Doctor Cards */
    .doctor-card {
        border-radius: 14px;
        padding: 20px;
        background: #ffffff;
        border-left: 5px solid #300a4f;
        box-shadow: 0 4px 12px rgba(48, 10, 79, 0.15);
        transition: 0.25s ease;
    }

    .doctor-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 6px 20px rgba(48, 10, 79, 0.25);
    }

    .doctor-name {
        font-weight: 700;
        color: #300a4f;
    }

    .doctor-special {
        color: #6a4d86;
        font-size: 0.95rem;
        margin-bottom: 8px;
    }

    /* Badges */
    .badge-running {
        background-color: #12a84c;
        font-size: 0.8rem;
    }

    .badge-complete {
        background-color: #300a4f;
        font-size: 0.8rem;
    }

    hr {
        border-color: #e6daee;
        margin: 12px 0;
    }

    /* Queue Button */
    .btn-queue {
        background-color: #300a4f;
        color: #fff;
        border-radius: 8px;
        padding: 6px 14px;
        font-size: 0.9rem;
        transition: 0.2s ease;
    }

    .btn-queue:hover {
        background-color: #200534;
        color: white;
    }

</style>

<div class="container py-4">

    <h2 class="dashboard-title"> Real-Time Token Status Monitor</h2>

    <div class="row g-4">
        {% for item in token_data %}
        <div class="col-md-4">
            <div class="doctor-card">

                <!-- Doctor Name -->
                <h5 class="doctor-name">{{ item.doctor.name }}</h5>

                <!-- Specialization -->
                <p class="doctor-special">
                    {{ item.doctor.specialization.department }}
                </p>

                <!-- Status Badge -->
                {% if item.status == "running" %}
                    <span class="badge badge-running">RUNNING</span>
                {% else %}
                    <span class="badge badge-complete">COMPLETED</span>
                {% endif %}

                <hr>

                <!-- Token Details -->
                <p><strong>Current Token:</strong> {{ item.current_token|default:"â€”" }}</p>
                <p><strong>Total Tokens Today:</strong> {{ item.total_tokens }}</p>

                <!-- View Queue Button -->
                <a href="{% url 'admin_doctor_queue' item.doctor.id %}"
                   class="btn btn-queue mt-2">
                    View Queue
                </a>

            </div>
        </div>
        {% endfor %}
    </div>

</div>

{% endblock %}
