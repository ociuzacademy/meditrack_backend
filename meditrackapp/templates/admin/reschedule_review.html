{% extends 'admin/admin_index.html' %}

{% block content %}

<style>

    /* Page Title */
    .page-title {
        text-align: center;
        font-weight: 800;
        color: #300a4f;
        margin-top: 30px;
        margin-bottom: 25px;
    }

    /* Card Container */
    .request-card {
        background: #ffffff;
        padding: 25px;
        border-radius: 16px;
        box-shadow: 0 4px 15px rgba(48, 10, 79, 0.15);
        border-left: 6px solid #300a4f;
        transition: 0.25s;
    }

    .request-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 20px rgba(48, 10, 79, 0.25);
    }

    /* Labels */
    .label {
        font-weight: 700;
        color: #300a4f;
    }

    /* Important Date Highlight */
    .highlight-date {
        font-weight: 700;
        color: #0077b6;
    }

    /* Buttons */
    .btn-approve {
        background-color: #12a84c;
        color: white;
        font-weight: 600;
        padding: 10px 22px;
        border-radius: 10px;
        border: none;
        margin-right: 12px;
        transition: 0.25s;
    }

    .btn-approve:hover {
        background-color: #0e7c3a;
        transform: translateY(-2px);
    }

    .btn-reject {
        background-color: #d90429;
        color: white;
        font-weight: 600;
        padding: 10px 22px;
        border-radius: 10px;
        border: none;
        transition: 0.25s;
    }

    .btn-reject:hover {
        background-color: #a1011d;
        transform: translateY(-2px);
    }

    /* Status Info Box */
    .info-box {
        background-color: #f3ecff;
        border-left: 5px solid #300a4f;
        padding: 15px;
        border-radius: 12px;
        color: #300a4f;
        font-weight: 600;
    }

</style>

<div class="container mt-4">

    <h2 class="page-title">Review Reschedule Request #{{ rr.id }}</h2>

    <div class="request-card">

        <p><span class="label">Doctor:</span> {{ rr.doctor.name }}</p>
        <p><span class="label">Appointment Date:</span> {{ rr.appointment_date }}</p>
        <p><span class="label">Token Range:</span> {{ rr.token_start }} â†’ {{ rr.token_end }}</p>
        <p><span class="label">Reason:</span> {{ rr.reason }}</p>
        <p><span class="label">Request Status:</span> {{ rr.status|title }}</p>

        <hr>

        <p><span class="label">Next Working Day After Original Date:</span>
            <span class="highlight-date">{{ proposed_next_working }}</span>
        </p>

        <p><span class="label">Final Reschedule Date (Next Working Day + 5 Days):</span>
            <span class="highlight-date">{{ proposed_reschedule_date }}</span>
        </p>

    </div>

    {% if rr.status == "pending" %}
    <form method="POST" class="mt-4">
        {% csrf_token %}
        <button name="action" value="approve" class="btn-approve">Approve</button>
        <button name="action" value="reject" class="btn-reject">Reject</button>
    </form>

    {% else %}
    <div class="info-box mt-4">
        This request has already been <strong>{{ rr.status|title }}</strong>.
        {% if rr.status == "approved" and rr.rescheduled_date %}
            <div class="mt-2">Rescheduled To: <strong>{{ rr.rescheduled_date }}</strong></div>
        {% endif %}
    </div>
    {% endif %}

</div>

{% endblock %}
